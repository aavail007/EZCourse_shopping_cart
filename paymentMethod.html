<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>付款方式</title>
    <link rel="stylesheet" href="css/plugin/bootstrap.min.css">
    <link rel="stylesheet" href="css/EZ_style.css">
    <script src="js/plugin/jQuery-v3.5.1.min.js"></script>
    <script src="js/plugin/bootstrap.min.js"></script>
</head>

<body>
    <header class="ez-nav fixed-top header-top">
        <nav class="navbar navbar-expand-md">
            <a class="navbar-brand" href="#">
                <img src="img/img_logo.svg" class="ez-logo" alt="...">
            </a>
        </nav>
    </header>

    <div class="wrap-content container">
        <h3 class="text-center mb-4">付款方式</h3>
        <div class="row">
            <div class="col-md-8 col-sm-12">
                <!-- 選擇付款方式（下拉） -->
                <div class="pay-method-div border-radius-shadow">
                    <div id="payMethodSelect" class="form-group pay-select">
                        <div class="custom-select">
                            <select>
                                <option value="1">信用卡</option>
                                <option value="2">ATM 轉帳</option>
                                <option value="3">超商付款</option>
                                <option value="4">Line Pay</option>
                            </select>
                        </div>
                    </div>
                    <div id="bankCodeSelect" class="form-group pay-select d-none">
                        <div class="custom-select">
                            <select>
                                <option value="822">822 中國信託</option>
                                <option value="812">812 台新銀行</option>
                                <option value="808">808 玉山銀行</option>
                                <option value="004">004 台灣銀行</option>
                            </select>
                        </div>
                    </div>
                    <!-- 選擇信用卡的內容 -->
                    <div id="creditCard" class="pay-method-content">下一步將連至第三方金流服務進行刷卡，你所有的交易資訊皆獲得安全保護。</div>
                    <!-- 選擇信用卡的內容 -->
                    <div id="atmTransfer" class="pay-method-content d-none">選擇銀行節省跨行轉帳手續費（如果沒有，需額外負擔 15 元跨行轉帳手續費）</div>
                    <!-- 超商付款的內容 -->
                    <div id="superBusiness" class="pay-method-content d-none">超商付款將加收 NT$30 手續費，若申請退費手續費將不進行退款。</div>
                    <!-- Line Pay的內容 -->
                    <div id="linePay" class="pay-method-content d-none">使用 LINE Pay 付款，你將被導入「LINE Pay」付款頁面進行安全結帳。</div>

                </div>
                <!-- 發票選項 -->
                <div class="pay-method-div border-radius-shadow mt-4">
                    <div class="fun-title">發票選項</div>
                    <hr>
                    <div>以下資訊只用於開立發票，並不會在其他頁面顯示。發票一經開立後不可更改，請確認資訊是否都填寫正確喔！</div>
                    <div>（ * 為必填欄位）</div>
                    <hr>
                    <form class="form-inline invoice-form">
                        <div class="form-group mt-3">
                            <label for="invoiceName">姓名<span class="small-red">＊</span></label>
                            <input id="invoiceName" type="text" class="form-control mx-sm-3" placeholder="請填入真實姓名">
                        </div>
                        <div class="form-group mt-3">
                            <label for="invoiceMail">聯絡用電子信箱<span class="small-red">＊</span></label>
                            <input id="invoiceMail" type="text" class="form-control mx-sm-3" placeholder="請輸入電子信箱">
                        </div>
                        <div class="form-group mt-3">
                            <label for="invoicePhone">手機號碼<span class="small-red">＊</span></label>
                            <input id="invoicePhone" type="text" class="form-control mx-sm-3" placeholder="請輸入手機號碼">
                        </div>
                    </form>
                    <hr>
                    <!-- 發票類型 -->
                    <div class="form-group pay-select">
                        <label for="invoicePhone">發票類型<span class="small-red ml-2">如需開立統編，請選擇統編發票</span></label>
                        <div class="custom-select">
                            <select>
                                <option>電子發票</option>
                                <option>統編發票</option>
                            </select>
                        </div>
                    </div>
                    <div class="">電子發票將在結帳完成後，寄送至你的電子信箱。</div>
                </div>
            </div>
            <div class="col-md-4 col-sm-12">
                <!-- 訂單明細 -->
                <div class="order-detail-div border-radius-shadow fixed-block">
                    <div class="fun-title">訂單明細</div>
                    <div class="order-detail">
                        <div class="row">
                            <div class="col-lg-6 col-6 col-md-12 mdtext-right">小計</div>
                            <div class="col-lg-6 col-6 col-md-12 text-right">NT$ 6900</div>
                            <div class="col-lg-6 col-6 col-md-12 mdtext-right">折扣代碼</div>
                            <div class="col-lg-6 col-6 col-md-12 text-right">NT$ -828</div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-lg-6 col-6 col-md-12 mdtext-right">超商手續費</div>
                            <div class="col-lg-6 col-6 col-md-12 text-right">NT$ 30</div>
                            <div class="col-lg-6 col-6 col-md-12 mdtext-right actually-title">實付金額</div>
                            <div class="col-lg-6 col-6 col-md-12 text-right total-sum">NT$6,102</div>
                        </div>
                        <hr>
                        <!-- 按鈕 -->
                        <div class="bottom-btn-div">
                            <button type="button" class="btn btn-primary ez-btn-md">下一步</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        $(function () {
            initSelect();

            /* If the user clicks anywhere outside the select box,then close all select boxes: */
            document.addEventListener("click", closeAllSelect);
        });

        function initSelect() {
            var x, i, j, selElmnt, a, b, c;
            /*look for any elements with the class "custom-select":*/
            x = document.getElementsByClassName("custom-select");
            for (i = 0; i < x.length; i++) {
                selElmnt = x[i].getElementsByTagName("select")[0];
                /*for each element, create a new DIV that will act as the selected item:*/
                a = document.createElement("DIV");
                a.setAttribute("class", "select-selected");
                a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
                x[i].appendChild(a);
                /*for each element, create a new DIV that will contain the option list:*/
                b = document.createElement("DIV");
                b.setAttribute("class", "select-items select-hide");
                for (j = 0; j < selElmnt.length; j++) {
                    /*for each option in the original select element,
                    create a new DIV that will act as an option item:*/
                    c = document.createElement("DIV");
                    c.innerHTML = selElmnt.options[j].innerHTML;
                    c.addEventListener("click", function (e) {
                        /*when an item is clicked, update the original select box,
                        and the selected item:*/
                        
                        // 如果是選擇付款方式的 select 才會觸發 changePayMethodContent()
                        var targetSelectId = $(e.target).parents('.pay-select').attr('id');
                        if(targetSelectId === 'payMethodSelect') {
                            changePayMethodContent(e.target.textContent);
                        }
                        var y, i, k, s, h;
                        s = this.parentNode.parentNode.getElementsByTagName("select")[0];
                        h = this.parentNode.previousSibling;
                        for (i = 0; i < s.length; i++) {
                            if (s.options[i].innerHTML == this.innerHTML) {
                                s.selectedIndex = i;
                                h.innerHTML = this.innerHTML;
                                y = this.parentNode.getElementsByClassName("same-as-selected");
                                for (k = 0; k < y.length; k++) {
                                    y[k].removeAttribute("class");
                                }
                                this.setAttribute("class", "same-as-selected");
                                break;
                            }
                        }
                        h.click();
                    });
                    b.appendChild(c);
                }
                x[i].appendChild(b);
                a.addEventListener("click", function (e) {
                    /*when the select box is clicked, close any other select boxes,
                    and open/close the current select box:*/
                    e.stopPropagation();
                    closeAllSelect(this);
                    this.nextSibling.classList.toggle("select-hide");
                    this.classList.toggle("select-arrow-active");

                });
            }
        }

        function closeAllSelect(elmnt) {
            /*a function that will close all select boxes in the document,
            except the current select box:*/
            var x, y, i, arrNo = [];
            x = document.getElementsByClassName("select-items");
            y = document.getElementsByClassName("select-selected");
            for (i = 0; i < y.length; i++) {
                if (elmnt == y[i]) {
                    arrNo.push(i)
                } else {
                    y[i].classList.remove("select-arrow-active");
                }
            }
            for (i = 0; i < x.length; i++) {
                if (arrNo.indexOf(i)) {
                    x[i].classList.add("select-hide");
                }
            }
        }

        function changePayMethodContent(type) {
            // debugger
            $('.pay-method-content, #bankCodeSelect').addClass('d-none');
            if (type === '信用卡') {
                $('#creditCard').removeClass('d-none');
            } else if (type === 'ATM 轉帳') {
                $('#atmTransfer').removeClass('d-none');
                $('#bankCodeSelect').removeClass('d-none');
            } else if (type === '超商付款') {
                $('#superBusiness').removeClass('d-none');
            } else if (type === 'Line Pay') {
                $('#linePay').removeClass('d-none');
            }


        }
    </script>
</body>

</html>